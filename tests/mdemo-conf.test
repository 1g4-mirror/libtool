#! /bin/sh
# mdemo-conf.test - try configuring the ../libltdl and ../mdemo subdirectories

# Test script header.
need_prefix=yes
if test -z "$srcdir"; then
  srcdir=`echo "$0" | sed 's%/[^/]*$%%'`
  test "$srcdir" = "$0" && srcdir=.
  test "${VERBOSE+set}" != "set" && VERBOSE=yes
fi
. $srcdir/defs || exit 1

# Maybe we have a VPATH build, in which case, create a new subdir.
test -d ../libltdl || mkdir ../libltdl

# Change to our build directory.
cd ../libltdl || exit 1

# Possibly clean up the distribution.
if test -f Makefile; then
  echo "= Running $make distclean in ../libltdl"
  $make distclean
fi
rm -f config.cache

# Configure libltdl.
echo "= Configuring in ../libltdl (prefix=$prefix)"
CONFIG_SITE=/dev/null ${CONFIG_SHELL-/bin/sh} $srcdir/../libltdl/configure --srcdir=$srcdir/../libltdl --prefix=$prefix || exit 1

# Maybe we have a VPATH build, in which case, create a new subdir.
test -d ../mdemo || mkdir ../mdemo

# Change to our build directory.
cd ../mdemo || exit 1

# Possibly clean up the distribution.
if test -f Makefile; then
  echo "= Running $make distclean in ../mdemo"
  $make distclean
fi
rm -f config.cache

# Configure the demonstration.
echo "= Configuring in ../mdemo (prefix=$prefix)"
CONFIG_SITE=/dev/null ${CONFIG_SHELL-/bin/sh} $srcdir/../mdemo/configure --srcdir=$srcdir/../mdemo --prefix=$prefix || exit 1

exit 0
