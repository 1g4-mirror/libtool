#! /bin/sh
# func_extract_archives.test

need_prefix=no
if test -z "$srcdir"; then
  srcdir=`echo "$0" | sed 's%/[^/]*$%%'`
  test "$srcdir" = "$0" && srcdir=.
  test "${VERBOSE+set}" != "set" && VERBOSE=yes
fi
. $srcdir/defs || exit 1
rm -f foo.o bar.o libfoo.a
SED=${SED-sed}
Xsed="$SED -e s/^X//"
for afile in baz foobar foobaz
do
    echo "$afile" > $afile.o
    ar -q libfoo.a $afile.o
    rm -f $afile.o
done
for anum in 1 2 3 4 5 6 7 8 9 10 11 12
do
    echo "foo $anum" > foo.o
    echo "bar $anum" > bar.o
    ar -q libfoo.a foo.o bar.o
done
test -d .libs || mkdir .libs

eval "`$SED -n -e '/^# Shell function definitions:'$z'$/,/^# End of Shell function definitions'$z'$/p' < $libtool`"

modename=libtool
show=echo
run=
mkdir=mkdir
rm="rm -f"
mv=mv
echo=echo
AR=${AR-ar}
func_extract_archives ".libs/libfoo" "libfoo.a"
for anum in 1 2 3 4 5 6 7 8 9 10 11 12
do
  test -f ".libs/libfoo/libfoo.a/foo-$anum.o" || exit 1
  $EGREP -v "foo-$anum" ".libs/libfoo/libfoo.a/foo-$anum.o" || exit 1
  rm -f ".libs/libfoo/libfoo.a/foo-$anum.o"
done
rm -rf ".libs/libfoo" libfoo.a bar.o foo.o
exit 0
