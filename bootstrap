#! /bin/sh

# helps bootstrapping libtool, when checked out from CVS
# requires at least GNU autoconf 2.58 and GNU automake 1.8

# Upgrade caveat

cat <<'EOF'
WARNING: If bootstrapping with this script fails, it may be due to an
WARNING: incompatible installed `libtool.m4' being pulled in to
WARNING: `aclocal.m4'.  The best way to work around such a problem is to
WARNING: uninstall your system libtool files, or failing that, overwrite
WARNING: them with `libtool.m4' as shipped with this distribution.
WARNING: After that, retry this bootstrap.
EOF

rm -rf `find . \( -name autom4te.cache -o -name libtool \) -print`

fakes="config/ltmain.sh config/libtoolize libltdl/ltmain.sh libltdl/libtoolize"

for file in $fakes; do
  touch $file
done

for sub in . tests/*demo tests/*demo[1-9]; do
  autoreconf --force --verbose --install $sub
done

for file in $fakes; do
  rm -f $file
done

# These files con cause an infinite configure loop if left behind.
rm -f Makefile libltdl/Makefile libtool

exit 0
