2000-09-03  Alexandre Oliva  <aoliva@redhat.com>

	* ltconfig.in (enable_dlopen): Set to no when lt_cv_dlopen is no.

	* libtool.m4 (AM_PROG_GCJ): Removed.
	(LT_AC_PROG_GCJ): Use AC_CHECK_TOOL.  Set GCJ to `no' if not
	found.
	* configure.in: Use LT_AC_PROG_GCJ.
	Reported by Nick Hudson <nick@nthcliff.demon.co.uk>

	* tests/quote.test: Move the match test out of case statements, to
	work around bug in /bin/sh of several OSs.

	* tests/defs (CC): Extract from the libtool script.
	* tests/link.test, tests/link-2.test, tests/quote.test: Use it.

	* ltmain.in (variables_saved_for_relink): Attempt to unset them
	instead of setting them to an empty string.

2000-09-02  Alexandre Oliva  <aoliva@redhat.com>

	* demo/Makefile.am: Don't extract configuration variables directly
	from the libtool script, since it breaks with multiple
	configurations.  Use $(LIBTOOL) --config instead.

	* tests/link-2.test: Create hell.lo in the format expected by
	libtool.

	* ltcf-c.sh, ltcf-cxx.sh, ltcf-gcj.sh (archive_cmds,
	archive_expsym_cmds) : Use compiler_flags instead of linker flags
	when $CC is used for linking.
	Reported by Alex Hornby <alex@anvil.co.uk>

2000-09-02  Makoto Ishisone  <ishisone@sra.co.jp>

	* libtool.m4 (lt_cv_deplibs_check_method, freebsd): Fix typo,
	add support for compact format library.

2000-09-02  Nick Hudson  <nick@nthcliff.demon.co.uk>

	* configure.in: AC_SUBST reload_flag, deplibs_check_method
	and file_magic_cmd.

2000-09-02  Tom Kacvinsky  <tjk@ams.org>, Tim Mooney <mooney@dogbert.cc.ndsu.NoDak.edu>

	* libtool.m4: Ignore Tru64's nm's complaint.

2000-09-02  Pavel Roskin <proski@gnu.org>

	* ltconfig.in: only load $cache_file if it's a regular file

2000-09-02  Assar Westerlund  <assar@sics.se>

	* ltconfig.in: Add back ranlib calls for static libraries if there
	is a ranlib.

2000-08-31  Gary V. Vaughan  <gvv@techie.com>

	sh.test was failing unnecessarily.

	* ltmain.in: Xsed is overkill on $CC, and removing it prevents
	the test suite from failing.

2000-08-31  Ossama Othman  <ossama@debian.org>

	* ltcf-c.sh, ltcf-cxx.sh, ltcf-gcj.sh: Removed RCD ID tags.  They
	were causing merge problems for those who maintain a copy of
	libtool in their own CVS repository.
	Reported by Bob Friesenhahn <bfriesen@simple.dallas.tx.us>

2000-08-27  Gary V. Vaughan  <gvv@techie.com>

	* ltconfig.in (with_gcc):  Make the value of this option
	available to the generated libtool script.
	* ltmain.in (compile_command, finalize_command):  The native C
	and C++ compilers on IRIX require the -LANG:std in order to to
	compile correctly.   The same options should _not_ be passed
	through to gcc on IRIX, or at all on other architectures for
	backwards compatibility (among others).
	Reported by Bob Friesenhahn <bfriesen@simple.dallas.tx.us>
	Reported by Albert Chin-A-Young <china@thewrittenword.com> 

2000-08-26  Albert Chin-A-Young  <china@thewrittenword.com>
	
	* ltcf-cxx.sh (old_archive_cmds):  With IRIX C++ 7.3.1.1m, CC -ar
	must be used to create archive libraries, not ar.
	
2000-08-01  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>

	* ltmain.in (shtool): Use echo|grep instead of expr, as in the
	original patch.

2000-08-01  Alexandre Oliva  <aoliva@redhat.com>

	* ltcf-c.sh (need_lc): Fix test message.  Set wl for archive_cmds.
	(ac_cv_prog_cc_pic): Don't print `cached' without `checking'.
	* ltcf-cxx.sh (need_lc): Set based on postdeps.

2000-07-26  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>

	* configure.in (AM_PROG_GCJ): Moved definition...
	* libtool.m4: ... here.

	* ltmain.in (tagname): Use `case' instead of `grep' to infer it.
	Match even when there are changes in white-space.
	(link): Accumulate base_compile so that -L flags that are part of
	$CC aren't retained.

2000-07-24  Mocha  <netbsd_alpha@yahoo.com>

	* ltconfig.in (NetBSD, deplibs_check_method): Use file_magic.
	(NetBSD, file_magic_cmd, file_magic_test_file): Set.

2000-07-24  Michael Matz  <matz@ifh.de>

	* ltcf-cxx.sh: Allow CC to have arguments.

2000-07-24  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>, David Kaelbling  <drk@orchietta.hudson.sgi.com>

	* ltmain.in (irix, major): Prepend a `.'.
	* ltconfig.in (irix, soname_spec, library_names_spec): Adjust.

2000-07-24  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>, Ralf S. Engelschall  <rse@engelschall.com>

	* ltmain.in: Support GNU shtool's install.

2000-07-24  Raja R Harinath  <harinath@cs.umn.edu>

	* tests/Makefile.am (COMMON_TESTS): New variable.
	(CXX_TESTS): Define unconditionally.
	(TESTS): Move all tests to COMMON_TESTS, and conditionally
	include CXX_TESTS.
	(EXTRA_DIST): Don't use $(TESTS).

2000-07-24  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>

	* ltcf-c.sh (linkopts): Don't set for test.
	* ltcf-cxx.sh (linkopts): Likewise.

2000-07-24  Nick Hudson <skrll@netbsd.org>

	* ltcf-cxx.sh (linkopts): Replace with linker_flags.

	* ltmain.in (ILD): fix addition of deplibs in relink case.

2000-07-19  H.J. Lu  <hjl@gnu.org>,  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>

	* ltcf-c.sh, ltcf-cxx.sh: Check if -lc is necessary for building
	shared library.
	* ltcf-gcj.sh: Assume -lc is implicitly linked in.
	* ltconfig.in: Set build_libtool_need_lc to indicate it.
	* ltmain.in: Add -lc when building shared library only if
	necessary.

2000-07-10  Mo DeJong  <mdejong@redhat.com>

	* libtool.m4 (AC_PROG_NM): Fix macro so that it
	finds a cross NM on the PATH.

2000-07-10  Ken Block <block@zk3.dec.com>

	* libltdl/ltdl.h: Also check for __cplusplus, __STDC__ is not
	by Compaq C++ compiler

2000-07-10  Alexandre Oliva  <aoliva@lsd.ic.unicamp.br>

	* ltcf-c.sh (wlarc, netbsd, aout): Set wlarc to empty.
	(hardcode_dynamic_flag_spec, export_dynamic_flag_spec): Use
	wlarc instead of wl.
	* ltcf-gcj.sh (wlarc, netbsd, aout): Set wlarc to empty.
	(hardcode_dynamic_flag_spec, export_dynamic_flag_spec): Use
	wlarc instead of wl.

	* ltconfig.in (dynamic_linker, linux, powerpc): Do not disable
	shared libraries just because of MkLinux.

2000-07-10  Albert Chin-A-Young  <china@thewrittenword.com>

	* ltcf-cxx.sh (archive_cmds, irix): Added -Wl to -update_registry
	and its argument when gcc is the compiler.

2000-07-10  Alexandre Oliva  <aoliva@lsd.ic.unicamp.br>

	* libtool.m4 (lt_cv_deplibs_check_method, freebsd): Do not depend
	on $version_type; check for ELF support as in other BSDs.

	* libtool.m4 (AC_LIBTOOL_GCJ): Require either AC_PROG_GCJ or
	AM_PROG_GCJ.
	(AC_PROG_LIBTOOL): Change internal comments to dnl, so that they
	don't make it to the `configure' script.

	* configure.in (AM_PROG_GCJ): Re-enable, with definition copied
	from CVS automake.

	* libtool.m4 (AM_PROG_GCJ): Quote it so that aclocal won't bring
	it in if it only appears in libtool.m4.
	(AC_PROG_LIBTOOL): Move AC_PROG_CXX, AC_PROG_GCJ and AM_PROG_GCJ
	hooks here, so that they can be far simpler!

2000-06-17  Syd Polk  <spolk@redhat.com>

	* libtool.m4 (AC_LIBTOOL_SETUP): Do not generate a libtool based
	on target; use host instead.
	* ltdl.m4 (AC_LTDL_SYSSEARCHPATH): Likewise.

2000-06-10  Ossama Othman  <ossama@debian.org>

	* libtool.m4: Updated comment.
	* ltcf-cxx.sh (archive_cmds, archive_expsym_cmds,
	hardcode_libdir_flag_spec, export_dynamic_flag_spec,
	whole_archive_flag_spec, with_gnu_ld): Added two default
	configurations for GNU g++ (one for g++ with GNU ld, and one for
	g++ with native linker).  Updated all platform-specific g++
	configurations to only be used if GNU ld isn't the backend linker.
	Added support for the KCC (Kuck and Associates, Inc. (KAI) C++
	Compiler) to the Linux and OSF/1 configurations.
	(ac_cv_prog_cc_wl): Added KAI C++ configuration.
	(archive_expsym_cmds): Some configurations were missing the
	argument that sets the name of the output library.
	* libltdl/ltdl.c, libltdl/libltdl.h: Synchronized with HEAD branch
	versions.

2000-06-10  Michael Matz  <matz@ifh.de>

	* ltcf-cxx.sh (whole_archive_flag_spec): Added missing back quotes
	(`) around a command that had to be evaluated.  This fixes GNU ld
	"--whole-archive" support detection.
	(wlarc): Fixed usage of $wlarc, which must be $wl in all cases,
	but when really using $LD for linking.

2000-06-10  Stephan Kulow  <coolo@kde.org>
	* ltmain.in (deplibs): Add the library paths to end of the
	deplibs, instead of the beginning, since deplibs is reordered
	later on.

2000-06-05  Ossama Othman  <ossama@debian.org>

	* ltcf-cxx.sh (compiler_lib_search_path), ltconfig.in
	(compiler_lib_search_path), ltmain.in (libs): The library path
	that the compiler uses internally was being placed before the one
	supplied by the user.  Added a loop that moves that path after the
	user supplied one.
	Reported by Stephan Kulow <coolo@kde.org> and Michael Matz
	<matz@ifh.de>

2000-05-30  Gary V. Vaughan  <gvv@techie.com>

	* ltconfig.in (ORIGINAL_CONFIG_SHELL): Prevent lossage when
	the echo probing code falls into this branch without setting
	this variable.

	* ltcf-c.sh (netbsd*): archive_cmds and archive_expsym_cmds
	were reversed with respect to definition of __ELF__.
	* ltcf-gcj.sh (netbsd*): ditto.
	From Keisuke Inoue <keisuke@csl.sony.co.jp>

2000-05-29  Gary V. Vaughan  <gvv@techie.com>

	* libtool.m4 (netbsd*): Use -L option to file_magic_cmd as for
	freebsd (below).
	* libtool.m4 (netbsd ELF): support file_magic.
	From Dan Winship <danw@helixcode.com>.

2000-05-29  Steven M. Schultz <sms@moe.2bsd.com>

	* libtool.m4 (bsdi4*): Add -L option to bsdi4's file_magic_cmd
	command.  Under BSD/OS 4.1 several libraries are now symlinks
	rather than regular files.  Adding -L tells the file program
	to follow the symlink.
			    
2000-05-29  Gary V. Vaughan  <gvv@techie.com>

	* libtool.m4 (i*86-*-freebsd*): Forgot to changequote(,).

	* NEWS: Updated.
	* libtool.m4 (i*86-*-freebsd*): Support a.out shared libs.
	From <suzukis@file.phys.tohoku.ac.jp>

2000-05-29  Fred Fish  <fnf@be.com>       

	Support AR=mwld AR_FLAGS='-xml -o' for PPC Beos.
	* ltconfig (old_AR_FLAGS): Add.              
	(old_archive_cmds): Use AR_FLAGS rather than hardcoding "cru".
	(archive_cmds): Use AR_FLAGS rather than hardcoding "cru".
	(AR_FLAGS): Default to "cru" if not set.
	* ltcf-c.sh: ditto.
	* ltcf-gcj.sh: ditto.

2000-05-29  Gary V. Vaughan  <gvv@techie.com>

	* ltconfig.in (echo): The following code actually prints the
	double quotes -- so I removed them:
	    echo='printf "%s\n"' /bin/ksh -c '$echo \\t'
	From Tuukka Toivonen <tutoivon@mail.student.oulu.fi>

	* NEWS: updated.

2000-05-29  Bernhard Rosenkraenzer <bero@redhat.de>
 
	* libtool.m4: adding ia64 as supported linux platform

2000-05-29  Michael Matz  <matz@ifh.de>

	* ltmain.in: fix quoting for $var_value.
       
	* ltconfig.in: check for dlfcn.h: include return value
	to make -Wall in CFLAGS work.  

2000-05-27  Ossama Othman  <ossama@debian.org>

	* ltmain.in: Make sure $arg is set when linking `.lo' files into a
	program.  Moved tag decision code after check for recognized
	source file extension (fixes "suffix" test failure).  Merged
	Rhapsody support from main trunk.
	(output_obj) Added missing '$' before "echo" command (fixes "sh"
	test failure).
	* tests/suffix.test: Corrected typo in error message, and improved
	the message.

2000-05-27  Gary V. Vaughan  <gvv@techie.com>

	* README-alpha: note new location of config.(guess|sub).

2000-05-26  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>

	* THANKS: Added Art Pope.

2000-05-26  Art Pope  <apope@sarnoff.com>

	* ltcf-cxx.sh: Examine $CC when recognizing the C++ compiler
	(it defaults to $CXX), and look at only its basename.

2000-05-26  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>

	* configure.in (GCJ): Check.
	* Makefile.am (CFLAGS, CPPFLAGS, CXXFLAGS, LDFLAGS, LIBS): Let
	automake define them implicitly.
	(EXTRA_DIST, pkgdata_DATA): Added ltcf-gcj.sh.
	(LIBTOOL_DEPS, LIBTOOL_CXX_DEPS, LIBTOOL_GCJ_DEPS): Define.
	(libtool): Depend on LIBTOOL_DEPS.  Add GCJ tag.
	(libtool, clibtool): Pass host_triplet to ltconfig.

	* libtool.m4 (_AC_PROG_LIBTOOL): Run before AC_LIBTOOL_GCJ.
	Add ltcf-c.sh to LIBTOOL_DEPS.  Run AC_LIBTOOL_CXX and
	AC_LIBTOOL_GCJ on demand.
	(AC_PROVIDE_IFELSE): Define for non-CVS autoconf compatibility.
	(AC_LIBTOOL_CXX): Accept multiple executions.  Add ltcf-cxx.sh
	to LIBTOOL_DEPS.  Reset config.log output.
	(AC_LIBTOOL_GCJ): New macro.
	* libtoolize.in: Copy ltcf-cxx.sh if AC_PROG_CXX is found.
	Copy ltcf-gcj.sh when appropriate.
	* doc/libtool.texi (AC_LIBTOOL_CXX): Doesn't have to be
	explicitly called.
	(AC_LIBTOOL_GCJ): Document.
	* tagdemo/configure.in (AC_LIBTOOL_CXX): Don't call.

	* ltmain.in (xform): Recognize *.class and *.java.
	(pic_flag): Do not add -DPIC.
	* ltcf-c.sh (ac_cv_prog_cc_pic): Add -DPIC.
	* ltcf-cxx.sh (ac_cv_prog_cc_pic): Add -DPIC.
	* ltcf-gcj.sh: New file, mostly copied from ltcf-cxx.sh.

	* ltmain.in: Output libobj file in a temporary file, then
	rename it.

	* ltconfig.in: Make the output script executable after updating
	available_tags.

	* ltmain.in (compile): When output object is in subdir, create
	the pic_object in subdir/objdir, not objdir/subdir.

2000-05-24  Ossama Othman  <ossama@debian.org>

	* libtool.m4 (AC_LIBTOOL_PICMODE): Merged this macro from the HEAD
	branch.
	(AC_LIBTOOL_CXX): Made sure CXX is exported to ltconfig.
	* ltcf-cxx.sh (ac_ext): Changed test source extension to "cc" to
	avoid potential ambiguities when using case-insensitive shells.
	(archive_expsym_cmds): Make sure soname is set otherwise
	-retain-symbol-file feature won't work.  The change was made for
	the Linux Compaq C++ and GNU G++ configurations.
	Reported by Stephan Kulow <coolo@kde.org>.
	* ltconfig.in, ltmain.in: Merged in changes from the HEAD branch.
	* tests/Makefile.am (clean-local): Fixed typo where a "distclean"
	was done in `mdemo' instead of the `tagdemo'.

2000-05-14  Alexandre Oliva  <oliva@lsd.ic.unicamp.br>

	* configure.in (ACINCLUDE_M4_LIST): Removed libltdl/acinclude.m4.
	* Makefile.am (aclocal_macros): Added ltdl.m4.
	(libltdl/acinclude.m4): Concatenate libtool.m4 and ltdl.m4.
	* bootstrap: Remove duplicate libltdl.

	* libtool.m4 (AC_LIBLTDL_CONVENIENCE, AC_LIBLTDL_INSTALLABLE):
	Pick LIBLTLD from top_builddir and INCLTDL from top_srcdir.
	* mdemo/configure.in: Remove comments on
	AC_LIBLTLD_CONVENIENCE.

	* configure.in: Look for C++ compiler.
	* Makefile.am (libtool): Configure CXX tag.
	* tests/Makefile.am: Test tagdemo only if CXX found.

	* libtool.m4 (_AC_PROG_LIBTOOL): Renamed from...
	(AC_PROG_LIBTOOL): Just AC_REQUIRE(_AC_PROG_LIBTOOL), to avoid
	effects of multiple runs.
	(_AC_PROG_LIBTOOL): Use AC_BEFORE to warn if called before
	AC_LIBTOOL_CXX.

	* tagdemo/Makefile.am (lib_LTLIBRARIES): Moved libbaz.la from
	noinst_LTLIBRARIES.

	* configure.in: Bump version number to 1.4a, since this will
	eventually become libtool 1.5.

2000-02-28  Ossama Othman  <ossama@debian.org>

	* ltmain.in (libobjs, reload_conv_objs): When searching for object
	files, search for "*.$objext," not "*.o."
	(compile_command, finalize_command, progfiles): No need to
	transform `.lo'	objects into standard `.o' objects.  `.lo' files
	are converted to the appropriate `.o' file earlier in the link
	mode code.
	* doc/libtool.texi (AC_LIBTOOL_CXX): Documented this
	macro, and the `tagdemo' test that utilizes it.  Updated C++ and
	tagged configuration documentation.

2000-02-25  Ossama Othman  <ossama@debian.org>

	* libtool.m4, ltconfig.in: Merged in changes from most recent HEAD
	branch version.
	* ltmain.in: Merged in changes from most recent HEAD branch
	version (ILD updates), and fixed parallel build error.
	* tagdemo/acinclude.m4, tagdemo/aclocal.m4, tagdemo/configure:
	regenerated these files against updated libtool.m4.

2000-02-22  Ossama Othman  <ossama@debian.org>

	* libtool.m4 (AC_LIBTOOL_CXX): Added missing "$lt_target" command
	line argument in call to `ltconfig'.  This fixes a problem that
	was occuring when a host type was specified by the user.  Also
	added missing "$reload_flag" environment.

2000-02-17  Ossama Othman  <ossama@debian.org>

	* libtoolize.in (files): Add C++ support if configure.in uses
	AC_LIBTOOL_CXX, i.e. add `ltcf-cxx.sh' to list of files to be
	copied during libtoolization.
	* ltdl.m4: Added this file to the multi-language branch.

2000-02-08  Ossama Othman  <ossama@debian.org>

	* ltcf-cxx.sh (predeps, postdeps, predep_objects,
	postdep_objects): Split {pre,post}deps into a variable that hold
	library dependencies and another that holds objects needed during
	shared library generation.  This was needed so that the objects
	needed for shared library generation do not get analyzed by the
	ILD mechanism.  The objects are only used during the initial
	creation of the shared library, not during subsequent links to
	that library.
	(archive_cmds, archive_expsym_cmds): Added $predep_objects before
	all objects and libraries, and $postdep_objects after them.  This
	is necessary when linking C++ shared libraries.
	(output_verbose_link_cmds): Added shared library generation
	compiler flag.  The objects and libraries the compiler links when
	creating shared libraries may be different than those used when
	linking programs, particulary for object files.
	* ltconfig.in (predep_objects, postdep_objects): Include these
	variables in the generated libtool script.
	* ltmain.in: Quote regular expression used for automatic tagged
	configuration selection.  Also improved the regular expression
	used for matching.
	Updated clean mode to work properly with the new `.lo' files.
	(libs): Only add $predeps and $postdeps to the list of dependency
	libraries when linking a library.
	* tagdemo/Makefile.am (noinst_LTLIBRARIES): Added another test
	library that depends on the existing test library.  It was added
	to exercise the ILD mechanism when using tagged configurations.
	(tagdemo_LDADD): The tagdemo program now depends on the new test
	library.  Since the new test library depends on the previous one,
	the previous library should be linked to the program as well.
	* Makefile.in: Regenerated from updated Makefile.am.
	* tagdemo/baz.cpp, tagdemo/baz.h: Added these sources.  They are
	new test library sources.
	* tagdemo/main.cpp (main): Added call to method in new test
	library.

2000-02-05  Ossama Othman  <ossama@debian.org>

	* ltmain.in: The "-R*" case in the loop that iterates through
	library dependencies doesn't handle the case of the "lib" link
	mode.  As such, the next iteration should immediately follow.  The
	"continue" inside the "if" block has been moved outside that
	block. 	Previously, the "-R*" case would just "fall through" when
	in "lib" link mode, but $lib="" which caused a "library not found"
	error later on.
	Reported by Stephan Kulow <coolo@kde.org>

2000-02-05  Ossama Othman  <ossama@debian.org>

	* bootstrap: Merged updates from HEAD branch.
	(sub): Added tagdemo to list of subdirectories to be
	bootstrapped.
	* ltcf-cxx.sh (AR): Removed redefinition of $AR to C++ compiler on
	Solaris for the Sun C++ and Green Hills C++ compilers.  `ar' must
	be used to extract object files from the archives, despite the
	fact that the archive must be created by the compiler.
	Reported by Stephan Kulow <coolo@kde.org>
	(predeps, postdeps): Remove any space between "-{L,R}" and the
	path.  Some compilers, such as HP aCC add space between them.
	* ltconfig.in (dlopen, dlopen_support): Merged updates from HEAD
	branch.
	* ltmain.in: Merged updates from HEAD branch.
	(libext): Do not reset $libext to `al' when creating convenience
	libraries.  Some compilers have problems with such a non-standard
	extension.
	Reported by Stephan Kulow <coolo@kde.org>
	* doc/libtool.texi: Merged updates from HEAD branch.
	* libltdl/Makefile.am, libltdl/configure.in, libltdl/ltdl.c,
	libltdl/ltdl.h: Merged updates from HEAD branch.

2000-02-03  Ossama Othman  <ossama@debian.org>

	* ltconfig.in (available_tags): The name of each newly added
	tagged configuration is appended to this list.  This is done at
	ltconfig time so that the generated `libtool' script need not
	determine which tags it supports everytime it is used.  The
	available_tags variable is used by `ltmain.in' to iterate over
	each of the tagged configurations when attempting to automatically
	choose which one to use for the supplied compile/link command.
	* ltmain.in: Added ability to automatically determine which tagged
	configuration to use based on the compiler found in the supplied
	base compile command.
	(available_tags): This new variable contains a list of available
	tagged configurations.  This gets generated at ltconfig time.
	(object_name, old_object): Renamed these to pic_object and
	non_pic_object, respectively.
	* doc/libtool.texi (Configuration tags): Updated documentation.
	Libtool now has the ability to infer which tagged configuration to
	use based on the compiler found in the supplied base compile
	command.
	* tagdemo/configure.in, tagdemo/configure: Removed explicit
	substitution of "--tag=CXX" in $LIBTOOL.  The newly added
	automatic selection of tagged configurations obviates the need to
	explicitly specify which tag to use.

2000-02-01  Ossama Othman  <ossama@uci.edu>

	* ltcf-cxx.sh: Added some untested HPUX aCC support.
	* ltmain.in: Inadvertently removed some of the tags patch.
	* tagdemo/Makefile.am, tagdemo/Makefile.in, tagdemo/README,
	tagdemo/acinclude.m4, tagdemo/aclocal.m4, tagdemo/configure,
	tagdemo/configure.in, tagdemo/foo.cpp, tagdemo/foo.h,
	tagdemo/main.cpp: *sigh* I checked this directory into the HEAD
	branch instead of the multi-language-branch.
	Reported by Stephan Kulow <coolo@kde.org>

2000-01-31 Ossama Othman  <ossama@debian.org>

	* configure.in (CONF_SUBDIRS): Added the `tagdemo' directory to
	the list.
	* ltcf-cxx.sh: Remove any residual `a.out' files resulting from
	the "eval $output_verbose_link_cmds."
	* ltconfig.in: Cleaned up nested quotes that were introduced with
	the tags patch.  This fixes part sh.test failure.
	* ltmain.in: Check if "$run" is of zero length before creating a
	`.lo' file.  This fixes the dryrun.test failure.
	Cleaned up nested quotes that were introduced with
	the tags patch.  This fixes another part sh.test failure.
	Remove "$libobj" not "libobj."
	Exit with an error if both $object_name and $old_object are set to
	"none" in the corresponding `.lo' file.  This should never happen.
	Changed remaining uses of "mkdir" to "$mkdir."
	Added dry run case to `.lo' case in link mode.  This fixes the
	link-2.test failure.
	(object_name, old_object): Prepend the subdirectory the `.lo'
	resides in to the object names extracted from the `.lo' file.
	This fixes the build-relink2.test failure.
	(tempemovelist): Use $echo "X..." instead of echo "..." since
	$Xsed is being used.  This fixes the last part of the sh.test
	failure.
	* tagdemo/Makefile.am, tagdemo/Makefile.in, tagdemo/README,
	tagdemo/acinclude.m4, tagdemo/aclocal.m4, tagdemo/configure,
	tagdemo/configure.in, tagdemo/foo.cpp, tagdemo/foo.h,
	tagdemo/main.cpp, tests/tagdemo-conf.test tests/tagdemo-exec.test
	tests/tagdemo-make.test tests/tagdemo-shared.test
	tests/tagdemo-static.test: Added a new tagdemo that exercises
	libtool's tagged configuration support found in the multilanguage
	branch.
	* tests/Makefile.am (TESTS): Added the tagdemo tests to the list.
	* tests/quote.test: Updated to HEAD branch version.  This fixes
	the quote.test failure.

2000-01-31 Ossama Othman  <ossama@debian.org>

	* ltconfig.in (compile_c_lo): Removed the test that checks if
	compiler support "-c -o file.lo" since the changes made to
	ltmain.in remove the need to do this.
	* ltmain.in:  Changed compile mode to generate `.lo' libtool
	objects, instead of generating PIC objects that end in `.lo'.
	These are analogous to libtool archive `.la' files.  They contain
	the name of the PIC and non-PIC objects.  All PIC objects will now
	be placed in `$objdir' (usually `.libs').  No changes to existing
	Makefiles should be necessary.  Libtool should work the same as it
	did prior to this change.  This change was necessary to correct a
	problem with Sun C++'s template repository mechanism since it
	couldn't handle repository objects ending in `.lo'.  This change
	causes some tests to fail, so it still needs some work.  The tests
	that fail are: dryrun.test, build-relink2.test, link-2.test.  The
	quote.test and sh.test tests also fail but they failed after the
	initial multi-language changes were made.

2000-01-25  Ossama Othman  <ossama@uci.edu>

	* libtool.m4, ltconfig.in, ltmain.in:  Merged updates found in
	HEAD branch.

	* ltcf-c.sh: Merged updates related to PIC flags and link
	characteristics from HEAD branch ltconfig.in.

2000-01-22  Ossama Othman  <ossama@debian.org>

	* libtool.m4 (AC_LIBTOOL_CXX): Added LDFLAGS to list of variables to
	pass to ltconfig when creating C++ compiler tag.

	* ltcf-cxx.sh: Added support for the DEC/Compaq C++ compiler on
	Linux and osf[3,4,5].

	(whole_archive_flag_spec): Corrected commands that check if GNU
	linker supports "--whole-archive" flag.  GNU C++'s
	"-print-prog-name" flag is used to determine what the linker is
	instead of using the 'LD' variable.

	(ac_cv_prog_cc_wl): Corrected value for Sun C++.  Previously it
	was set to '-Wl,' when it should have been '-Qoption ld '.

	* ltconfig.in (ac_cv_prog_cc_pic_works,
	ac_cv_prog_cc_static_works): Make sure variable is not an empty
	string, even if it is set.

1999-12-06  Ossama Othman  <ossama@debian.org>

	* ltcf-c.sh: split off the osf3 section, so that the osf4 and osf5
	sections can add `-msym' to arguments passed to the linker for
	shared libs.
	Reported by Tim Mooney  <mooney@dogbert.cc.ndsu.NoDak.edu>

1999-12-05  Ossama Othman  <ossama@debian.org>

	* libtool.m4 (AC_LIBTOOL_SETUP): Temporarily reset the test
	language to C just before calling AC_OBJEXT and AC_EXEEXT and then
	restore the previous one when done, instead of doing an
	AC_BEFORE(...AC_LANG_CPLUSPLUS...).  A warning would always occur
	anyway because AC_PROG_CXX calls AC_LANG_CPLUSPLUS.

1999-12-05  Ossama Othman  <ossama@debian.org>

	* libtool.m4 (AC_LIBTOOL_SETUP): Make sure AC_LIBTOOL_SETUP is
	called before any macros that set the autoconf test language
	(e.g. AC_LANG_CPLUSPLUS).  Autoconf's AC_EXEEXT macro only works
	for C compilers.  AC_EXEEXT gets confused and thinks that an
	extension such as the C++ source file extenstion ".C" is an
	executable file extension, which screws up the libtool
	configuration.

	Pass the same autoconf variables used in the main ltconfig run to
	the ltconfig configuration tag run (with the exception of a few).
	This probably isn't necessary but I think it is a good idea to do
	so.

	* ltconfig.in: The tagged configuration was being cached and
	overwriting the C compiler cached configuration.  For now,
	the tagged configuration will not be cached.

1999-12-04  Ossama Othman  <ossama@debian.org>

	* ltconfig.in: Made "appending to libtool" message more
	descriptive.

1999-12-04  Ossama Othman  <ossama@debian.org>

	With this latest set of updates I was able to build a C++ shared
	library using a C++ configuration tag for g++ on Linux!  Some may
	think that this isn't much of an accomplishment but static
	constructors appear to work now, whereas prior to the addition of
	the multi-language support patches they didn't.

	* libtool.m4 (AC_LIBTOOL_CXX): Made invocation of ltconfig more
	like the one in AC_PROG_LIBTOOL.  This adds some ILD related flags
	to the invocation, in addition to providing the $libtool_flags to
	ltconfig that was previously in AC_PROG_LIBTOOL (via
	AC_LIBTOOL_SETUP).  This fixes an ILD related bug with the C++
	support, and also fixes a problem where both the static and shared
	libraries were being built even if one of them was explicitly
	disabled.
	
	* ltcf-cxx.sh: Make sure $ac_cv_prog_cc_pic_works and
	$ac_cv_prog_cc_static_works are unset since their C compiler
	cached values will override their C++ compiler specific values.
	Note that it was not enough to reset their values.  They had to be
	unset.

1999-12-04  Ossama Othman  <ossama@debian.org>

	* doc/libtool.texi: Moved "LTCC" in "--add-tag" example before
	"CC" because users may inadvertently do something like the
	following:

		CC=$CXX LTCC=$CC ./ltconfig --add-tag=...

	Doing the above would set LTCC to the C++ compiler ($CXX), which
	is incorrect since LTCC should be the C compiler.  Also added
	documentation explaining this potential problem.

	* Makefile.am (EXTRA_DIST): Added ltcf-c.sh, ltcf-cxx.sh and
	ChangeLog.1 to list of files to include in the distribution.
	(pkgdata_DATA): Added ltcf-sh.sh and ltcf-cxx.sh to the list of
	data files.

	* libtool.m4 (AC_LIBTOOL_CPP): Change name of macro that enables
	C++ support in libtool from "AC_LIBTOOL_CPP" to "AC_LIBTOOL_CXX."
	"CPP" is typically associated with preprocessors, whereas CXX is
	associated with C++ compilers.

	Moved LTCC before CC in call to ltconfig to make sure LTCC is not
	set to the compiler pointed to by CC after CC has been reset to
	another compiler.

	Call ltconfig with ${CONFIG_SHELL-/bin/sh} just like we do in
	AC_PROG_LIBTOOL.

	Save value of $CC and $CFLAGS before resetting them for use with
	configuration tags.

	* libtoolize.in (files): Added ltcf-c.sh to list of files related
	to "libtoolization."  Until we decide if other compiler/language
	libtool configuation scripts should also be included in the file
	list, leave out ltcf-cxx.sh for now.

	* ltcf-cxx.sh (ld_shlibs): Disable shared library support for
	currently unconfigured platforms. Updated IRIX, Linux and Solaris
	link characteristics.  They now match more with their C compiler
	counterparts.

	* ltconfig.in: Corrected tag name variable in "END LIBTOOL TAG
	CONFIG: $tagname" text.

1999-12-03  Ossama Othman  <ossama@debian.org>

	* Makefile.am, libtool.m4, ltconfig.in, ltmain.in,
	doc/libtool.texi, tests/defs: The beginnings of
	multi-compiler/language support in libtool.

	Integrated Alexandre's configuration tags patch, part of Thomas'
	patch and part of my patch.

	These patches make it possible for libtool to support
	compilers besides C compilers.  This also includes support for
	linkers besides `ld', and similarly for other tools commonly used
	for development.  See the libtool documentation for more details.

	Moved all C compiler related configuration code to `ltcf-c.sh',
	described below.

	Multi-compiler/language still isn't complete but testing is now
	possible.

	* ltcf-c.sh: Added this file.  It contains all of the C compiler
	related configuration code that was previously in ltconfig.in.
	This script is meant to be sourced by the ltconfig script alone.
	It is not meant for use by the user.  Eventually, the contents of
	this file will be moved to `libtool.m4'.

	* ltcf-cxx.sh: Added this file.  It contains C++ compiler related
	configuration code (e.g. C++ compiler as linker, etc).  It is
	meant to be used	when creating configuration tags using the
	newly added "--add-tag" ltconfig option.  See the libtool
	documentation for more details.  Eventually, the contents of this
	file will be moved to 	`libtool.m4'.

	This script also includes support for extracting the objects and
	libraries the compiler would use when linking a C++ binary.  This
	support should allow static constructors and the like to work
	properly.

Continued in ChangeLog.1

	$Revision$ $Date$
