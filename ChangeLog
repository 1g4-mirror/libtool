2009-01-26  Peter Rosin  <peda@lysator.liu.se>

	Don't settle for any dumpbin/link program as name lister.
	* libltdl/m4/libtool.m4 (LT_PATH_NM): When locating dumpbin or
	link -dump, check if they appear to really be capable of name
	listing, in order to eliminate e.g. link from coreutils. This
	makes the name lister decision fall back on nm as the default if
	no acceptable candidate is found, which mainly happens on
	(arguably broken) cross compiles.
	* NEWS: Update
	* THANKS: Update
	Reports by Rudolf Leitgeb and Peter Kjellerstedt.

2009-03-03  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Document INNER_TESTSUITEFLAGS, drop leading space.
	* README: Document INNER_TESTSUITEFLAGS.
	* tests/cmdline_wrap.at (Run tests with low max_cmd_len):
	When using INNER_TESTSUITEFLAGS on the testsuite invocation,
	drop leading space after "-k libtool", so that the user may
	further limit the set of tests to be run.

2009-03-02  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Fix low max_cmd_len template test on UnixWare.
	* libltdl/config/ltmain.m4sh (func_mode_link): When expanding
	$reload_cmds, always put objects in $reload_objs rather than
	adding them to the command line, to allow more general command
	lines in reload_cmds.  Ensure $reload_objs contains a leading
	space.
	* libltdl/m4/libtool.m4 (_LT_LANG_CXX_CONFIG) [sysv5*,
	sco3.2v5*, sco5v6*] <reload_cmds>: For CC, invoke prelinker
	before creating reloadable object.
	(_LT_CMD_RELOAD) <reload_cmds, reload_flag>: Declare as
	_LT_TAGDECL, not _LC_DECL.
	(_LT_LANG_CXX_CONFIG, _LT_LANG_F77_CONFIG, _LT_LANG_FC_CONFIG)
	(_LT_LANG_GCJ_CONFIG) <reload_cmds, reload_flag>: Initialize
	from default (C tag) value.
	* THANKS: Update.
	Report and analysis by Tim Rice and John Wolfe.

2009-02-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* doc/libtool.texi (Distributing libltdl, Test descriptions):
	Add missing parentheses.

2009-02-28  Tim Rice  <tim@multitalents.net>

	Fix C++ template handling for old archives on UnixWare 7.1.4.
	* libltdl/m4/libtool.m4 (_LT_LANG_CXX_CONFIG) [sysv5*,
	sco3.2v5*, sco5v6*] <old_archive_cmds>: For CC, add template
	prelink step before archiving.  Fixes template.at test failures.

2009-02-28  Török Edwin  <edwintorok@gmail.com>  (tiny change)
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Do not add bogus directory arguments to link command lines.
	* libltdl/config/ltmain.m4sh (func_mode_link): Ensure $path is
	always initialized before it is used.  Reported for zsh, for
	which $path contains $PATH entries even after "emulate sh", see
	<http://bugs.debian.org/517501>.

2009-02-28  Andreas Schwab  <schwab@suse.de>
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Remove remaining references to CVS.
	* bootstrap: Remove references to CVS.
	* README.alpha: Likewise.
	* clcommit.m4sh: Likewise.
	* doc/libtool.texi: Bump copyright years.
	(libtool script contents): Describe macro_revision as revision
	without reference to CVS.

2009-02-16  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Do not pass $INSTALL via TESTS_ENVIRONMENT.
	* Makefile.am (TESTS_ENVIRONMENT): Set lt_INSTALL, not INSTALL,
	so that a bogus relative path to the install-sh script in the
	source tree is not propagated to the configure scripts of the
	old test suite.
	* tests/testsuite.at: Adjust.
	* tests/install.at (Install tests): Likewise.

2009-02-03  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Kurt Roeckx <kurt@roeckx.be>

	New test for lt_dlopenext error message.
	* tests/lt_dlopenext.at (lt_dlopenext error messages): New file,
	with new test, with sources taken from the Autobook example.
	* Makefile.am: Update.

2009-02-03  Kurt Roeckx <kurt@roeckx.be>

	lt_dlopenext sets error upon successful library load.
	* libltdl/ltdl.c (lt_dlopenadvise): Fix bogus error on
	successful loading of library with lt_dlopenext.
	Report by Kaiwang Chen in <http://bugs.debian.org/510006>.

2009-02-01  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Fix sed script in install.at.
	* tests/install.at (Install tests): Fix typo in sed script,
	fixes test failure on HP-UX.

	Fix $INSTALL in testsuite with relative path to install-sh.
	* tests/testsuite.at: If `$INSTALL' points to in-tree
	install-sh, override a possibly-relative path to it with an
	absolute one.

	install mode: do not pass `-m $install_override_mode' to cp.
	* libltdl/config/ltmain.m4sh (func_mode_install): New variable
	$install_cp, factor test when `cp' is used for installation.
	Do not pass mode override to cp.  Fixes `libtool --mode=install
	cp ...' on HP-UX; cp should not be used for libraries that might
	be needed by programs invoked during the installation process.

	Fix sed script portability issue in func_version.
	* libltdl/config/getopt.m4sh (func_version): Remove space in
	`/\./! {' sed command, to please HP-UX sed.

2009-01-31  Jeff Squyres <jsquyres@cisco.com>
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	New test for bogus lt_dlopen error message.
	* tests/lt_dlopen.at (lt_dlopen error messages): New file, new
	test, marked as XFAIL for now.
	* Makefile.am: Adjust.
	Report and reproducible test case by Jeff Squyres.

2009-01-31  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	execute mode: do not transform *.lo or *.la arguments.
	* libltdl/config/ltmain.m4sh (func_mode_execute): Do not check
	arguments matching *.lo or *.la for script wrappers.
	* tests/execute-mode.at (execute mode): Add tests.
	* NEWS, THANKS: Update.
	Report by Paul Biggar.

	Nonexistent `main' does not guarantee link failure.
	* tests/fail.at (Failure tests): Use an unresolved symbol,
	rather than non-presence of `main', to provoke a link failure
	also on QNX.  Only check for failure of the libtool script if
	the link without libtool would have failed, too.
	Report by Mike Gorchak.

	Use AT_CHECK more liberally in duplicate members test.
	* tests/duplicate_members.at (duplicate members in archive
	tests): Wrap link commands in AT_CHECK, they might fail, as seen
	on QNX.
	* THANKS: Update.
	Report by Mike Gorchak.

2009-01-30  Akim Demaille  <demaille@gostai.com>

	Fix cwrapper warnings from MSVC 2005.
	* libltdl/config/ltmain.m4sh (func_emit_cwrapperexe_src)
	[file scope]: define _CRT_SECURE_NO_DEPRECATE.

2009-01-29  Akim Demaille  <demaille@gostai.com>

	Fix bootstrap with older libtool.m4 in reach of aclocal.
	* libltdl/m4/lt~obsolete.m4: Add stub definitions for
	_LT_REQUIRED_DARWIN_CHECKS and _LT_AC_PROG_CXXCPP.

	Fix func_exec_init.
	* tests/defs.m4sh (func_exec_init): Instead of using the undefined
	my_dir, call func_dirname_and_basename and use its result.
	(func_make): For consistency, don't use the useless local variable
	my_dir.

2009-01-29  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Document --mode short-hands better, and test them.
	* doc/libtool.texi (Invoking libtool): Give examples for using
	the `--mode=MODE' short-hand `MODE', or abbreviations thereof.
	* libltdl/config/ltmain.m4sh: Mention the short-hand for MODE
	in the --help output.
	* tests/help.at (mode short-hands): New test group.
	Suggestion by Bruno Haible.

	func_version copes with multi-line copyright headers.
	* libltdl/config/getopt.m4sh (func_version): Slurp in copyright
	lines until a period is found.
	* libltdl/config/ltmain.m4sh: Multi-line copyright is ok to use
	now.
	* tests/help.at (standard command line options): New file, new
	tests.  Make this test group the first one for libtool tests,
	moving the banner ...
	* tests/duplicate_members.at: ... from here.
	* Makefile.am (TESTSUITE_AT): Add tests/help.at.

2009-01-29  Akim Demaille  <demaille@gostai.com>
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Normalize compiler output due to compiler wrappers.
	* tests/testsuite.at (LT_AT_NORMALIZE_COMPILER_OUTPUT): New
	macro, to normalize ccache and distcc output.
	* tests/localization.at (localized compiler messages): Use it.

2009-01-29  Peter Rosin  <peda@lysator.liu.se>

	Make modified libtool script in cwrapper test executable
	* tests/cwrapper.at: Make modified libtool script executable.
	Report by Roumen Petrov.

2009-01-28  Akim Demaille  <demaille@gostai.com>

	Clean space uses.
	* libtoolize.m4sh: Remove trailing spaces.
	Use <tab><sp>, as some editors remove "useless" spaces in
	<sp><tab>.

2009-01-26  Peter Rosin  <peda@lysator.liu.se>

	AWK is required, make sure it is set.
	* libltdl/m4/libtool.m4 (_LT_CMD_GLOBAL_SYMBOLS: Make sure
	AWK is set (automake brings it in, but is not always used).
	Fixes old-m4-iface.at on MSYS/MSVC.

2009-01-25  Mike Frysinger  <vapier@gentoo.org>

	Fix typo in libtool install mode documentation.
	* libltdl/config/ltmain.m4sh (func_mode_help): Change -inst-prefix
	to -inst-prefix-dir.
	* doc/libtool.texi (Install mode): Likewise.

2009-01-24  Charles Wilson  <libtool@cwilson.fastmail.fm>

	Add -Wall to cwrapper tests.
	* tests/cwrapper.at: Add -Wall existing tests. Add additional
	round of tests with -Wall alone.

2009-01-24  Charles Wilson  <libtool@cwilson.fastmail.fm>

	[cygwin|mingw] cwrapper cleanups.
	* libltdl/config/ltmain.m4sh (func_emit_cwrapperexe_src)
	[file scope]: re-organized includes and portability
	macros. Avoid oldnames on MINGW32 and MSVC for
	setmode/stat/chmod/getcwd/putenv. Declare _putenv on
	MINGW32 when -ansi. Use namespaced macro LT_DEBUGWRAPPER.

2009-01-24  Peter Rosin  <peda@lysator.liu.se>

	Expand exit status test in LT_AT_NOINST_EXEC_CHECK correctly
	* tests/testsuite.at (LT_AT_NOINST_EXEC_CHECK): STATUS is
	argument $3, not $2.

2009-01-23  Charles Wilson  <libtool@cwilson.fastmail.fm>

	Add tests for cwrapper with -std=c89 and -std=c99
	* tests/cwrapper.at: New file.
	* Makefile.am: Add tests/cwrapper.at.

2009-01-22  Peter Rosin  <peda@lysator.liu.se>

	Unify line endings in localization test.
	* tests/testsuite.at: Update copyright year.
	(LT_AT_UNIFY_NL): Add macro that unifies line endings on
	platforms that suffer from such confusion.
	* tests/localization.at: Use it. Update copyright year. Fixes
	the test on MSYS/MSVC.

2009-01-21  Charles Wilson  <libtool@cwilson.fastmail.fm>

	[cygwin|mingw] Fix compile warnings when -std=c89.
	* libltdl/config/ltmain.m4sh (func_emit_wrapper_part1):
	move contents to...
	(func_emit_wrapper_part2): move contents to...
	(func_emit_wrapper): here.
	(func_emit_cwrapperexe_src) [file scope]: Remove
	variables script_text_part1 and script_text_part2.
	(func_emit_cwrapperexe_src) [lt_dump_script]: New function.
	(func_emit_cwrapperexe_src) [main]: Call it.

2009-01-21  Charles Wilson  <libtool@cwilson.fastmail.fm>

	Minor cygwin cleanup
	* libltdl/config/ltmain.m4sh (func_generate_dlsyms): Correct
	case pattern for cygwin.

2009-01-19  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Avoid failure due to Cygwin path detection bug.
	* tests/execute-mode.at (execute mode): Ignore noise on stderr;
	Cygwin might consider `d\"e' to be a DOS-style path and warn.
	Report by Charles Wilson.

2009-01-19  Robert Millan  <rmh@aybabtu.com>

	Support GNU/kOpenSolaris.
	* libltdl/m4/libtool.m4 (_LT_SYS_DYNAMIC_LINKER)
	(_LT_CHECK_MAGIC_METHOD, _LT_COMPILER_PIC, _LT_LINKER_SHLIBS)
	(_LT_LANG_CXX_CONFIG) [kopensolaris*-gnu]: Recognize
	GNU/kOpenSolaris.
	* libltdl/m4/ltdl.m4 (LT_SYS_DLOPEN_DEPLIBS): Likewise.
	* NEWS, THANKS: Update.

2009-01-19  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Another LT_AT_EXEC_CHECK fixup.
	* tests/shlibpath.at (shlibpath_overrides_runpath): Use
	LT_AT_EXEC_CHECK instead of AT_CHECK.

2009-01-19  Roumen Petrov  <bugtrack@roumenpetrov.info>  (tiny change)

	Add missing $EXEEXT to java test.
	* tests/convenience.at (Java convenience archives): Add $EXEEXT.

2009-01-19  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Bump copyright years.
	* ChangeLog.2008: New, rotated from ...
	* ChangeLog: ... here.
	* Makefile.am (EXTRA_DIST): Add ChangeLog.2008.
	* NEWS, libltdl/config/ltmain.m4sh: Bump copyright years.
	* libltdl/m4/libtool.m4 (_LT_COPYING, LT_OUTPUT): Likewise.
	* libtoolize.m4sh: Likewise.

2009-01-14  Peter Rosin  <peda@lysator.liu.se>

	Fix flakey mdemo-dryrun test on MSYS (again!)
	* tests/mdemo-dryrun.test: ls -l in MSYS sometimes shows year,
	not time, for really fresh files. Add sleep 1 call at yet another
	strategic position. Makes the test pass reliably for MSYS/MinGW.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* libltdl/config/ltmain.m4sh (func_mode_ar): New function
	implementing new libtool --mode=ar.
	(func_mode_help): Describe new ar mode.
	* libltdl/m4/libtool.m4 (_LT_PROG_AR): Don't AC_SUBST AR_SEP
	and AR_TFLAGS since they are no longer needed outside the
	libtool script. Instead AC_SUBST LT_AR and LT_ARFLAGS and set
	them so that libtool --mode=ar is invoked if the archiver is
	"strange".
	* Makefile.am: Don't export AR_SEP to the testsuite, instead
	export LT_AR and LT_ARFLAGS.
	* tests/archive-in-archive.at: Use "$LT_AR t " instead of
	"$AR $AR_TFLAGS$AR_SEP".
	* doc/libtool.texi: Document new mode.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* libltdl/m4/libtool.m4 (_LT_LINKER_SHLIBS)
	[ cygwin, mingw, cegcc ] <cl*>: @OUTPUT@ may or may not
	include a trailing $EXEEXT. If mt fails, make sure libtool
	exits with an error.
	(_LT_LANG_CXX_CONFIG): Likewise.
	* tests/exeext.at: New. Make sure linking with both -o prog
	and -o prog$EXEEXT works.
	* Makefile.am: Add previous test to testsuite.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* doc/libtool.texi (libtool script contents): Document
	new variables introduced by the MSVC port.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* libltdl/m4/libtool.m4 (_LT_LINKER_SHLIBS)
	[cygwin, mingw, pw32, cegcc] <cl*>: Indicate that reloadable
	objects does not work.
	* tests/duplicate_conv.at: Skip last test if reloadable
	objects does not work.
	* doc/libtool.texi (libtool script contents): Document how to
	indicate that reloadable objects do not work.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* .gitignore: Ignore *.obj files for MSVC (and w32).

2009-01-13  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/libtool.m4 (LT_PATH_NM): Move setting of
	nm_file_list_spec ...
	(_LT_CMD_GLOBAL_SYMBOLS): ... here.  Also enable for GNU nm if
	supported.

	* tests/static.at (ccache -all-static): Ignore compiler stderr.
	Reported by Peter Rosin.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* tests/stresstest.at [MSVC]: dllimport all imported
	variables.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* tests/stresstest.at: Link with main.lo when liba is shared
	and linking main with -no-install.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* tests/link-order.at [MSVC]: Always dllimport exported
	variables.

2009-01-13  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/m4/libtool.m4 (_LT_PROG_AR, LT_PATH_NM): Fix bogus
	uses of _LT_TAGVAR.  Hide `ar' error message escape from command
	line.

2009-01-13  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
	    Peter Rosin  <peda@lysator.liu.se>

	Support for response files with $NM.
	* libltdl/m4/libtool.m4 (_LT_LINKER_SHLIBS) <nm_file_list_spec>:
	New tag variable.
	[ cygwin, mingw, cegcc ] <cl*>: Set to '@'.
	(_LT_LANG_CXX_CONFIG): Likewise.
	* libltdl/config/ltmain.m4sh (func_mode_link): When
	nm_file_list_spec is nonempty, use it to avoid skipped_export.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* libltdl/m4/libtool.m4 (_LT_LINKER_SHLIBS) <postlink_cmds>:
	New tag variable.
	[ cygwin, mingw, cegcc ] <cl*>: Embed the manifest file as a
	resource.
	(_LT_LANG_CXX_CONFIG): Likewise.
	* libltdl/config/ltmain.m4sh (func_mode_link): After linking
	a program, replace @OUTPUT@ in $postlink_cmds and then execute
	the commands.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* libltdl/m4/libtool.m4 (_LT_CHECK_MAGIC_METHOD): Disable nocase
	handling for cross compiles.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	* tests/export.at [MSVC]: dllimport all imported variables.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	Add MSVC support.
	* libltdl/m4/libtool.m4: Add support for Microsoft Visual C.
	* NEWS: Add note of the above.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	Allow the use of a file listing file if the archiver supports
	it.  Add hint so that the Microsoft lib archiver uses the file
	listing feature.
	* libltdl/m4/libtool.m4 (_LT_PROG_AR): Indicate if the
	archiver supports a listing file with the new variable
	archiver_list_spec.
	* libltdl/config/ltmain.m4sh: If the archiver supports
	a listing file, use it when max_cmd_len is exceeded.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	MSVC doesn't support the -l option, instead it expects the exact
	library file name. Retain the -l option as long as possible as
	libtool recognizes -l internally. Then, as late as possible
	transform the -l option to an exact file name (-lfoo ->
	foo.lib).
	* libltdl/m4/libtool.m4: Add tag variable dashl_xform which
	specifies how to transform -l options for the linker.
	* libltdl/config/ltmain.m4sh (func_mode_link): Transform -l
	options using dashl_xform right before creating the
	program or library.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	MSVC needs a hint to force it to compile either as C or C++.
	* libltdl/m4/libtool.m4: Add tag variable compile_tag to
	enable tag specific compiler options that are bad in the
	linking phase.
	* libltdl/config/ltmain.m4sh: Add the tag specific options
	to the compile command line.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	The MSVC linker doesn't have a -L option, and doesn't understand
	posix paths.  Move paths to an envvar with a prefix (-LIBPATH:).
	* libltdl/m4/libtool.m4: Add new tag variables to specify
	to what variable (dashL_envvar) -L options should be moved,
	and what to prepend to the -L path (dashL_envvar_spec).
	* libltdl/config/ltmain.m4sh (func_dashL_to_envvar): New
	function that moves -L options to a variable.
	* libltdl/config/ltmain.m4sh (func_mode_link): Prior to
	linking, call above function if dashL_envvar is set.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	On Windows, find potential libs regardless of file name case.
	* libltdl/m4/libtool.m4 (_LT_CHECK_MAGIC_METHOD),
	libltdl/config/ltmain.m4sh (func_mode_link): On Windows,
	find potential libs regardless of file name case.
	* tests/nocase.at: New test, to check for regressions
	of the above.
	* Makefile.am: Add above new test.

2009-01-13  Peter Rosin  <peda@lysator.liu.se>

	Allow Microsoft lib to be used as the archiver.
	* libltdl/m4/libtool.m4 (_LT_PROG_AR): New macro, detect the
	interface used by the archiver. In particular, add the AR_SEP
	variable to allow archivers that does not allow a space between
	the options to create an archive and the archive name and the
	ar_extract_one_by_one variable which indicates if the archiver
	can extract all members in one go.
	* libltdl/m4/libtool.m4: Add $AR_SEP between $AR_FLAGS and the
	archive file name in all $AR commands.
	* libltdl/config/ltmain.m4sh (func_extract_an_archive): Add support
	for archivers that only supports extracting one member at a time
	and otherwise adjust to the above libtool.m4 changes. Also, add
	$AR_SEP to the $AR invocations.
	* Makefile.am: Pass AR, AR_FLAGS and AR_SEP through to the
	testsuite.
	* tests/archive-in-archive.at: Extract archive name from the .la
	file instead of hardcoding the name, and allow different archivers.

Continued in ChangeLog.2008

vim:tw=72
