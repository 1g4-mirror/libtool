2005-05-13  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* THANKS: Updated.

2005-05-06  Gary V. Vaughan  <gary@gnu.org>

	* libltdl/m4/ltdl.m4 (LT_WITH_LTDL): Propogate ltdl directory.

2005-05-02  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* Makefile.am (stamp-vcl): Use `diff' instead of `cmp'.

2005-04-30  Gary V. Vaughan  <gary@gnu.org>

	Revert the parallel installation changes from November last year:

	* libtoolize.m4sh (pkgdatadir, aclocaldir): Substituted from
	configure.
	(func_copy_all_from_path): Removed.  No longer used.
	(func_copy_some_files): Simplify now that nothing is copied from a
	list of possible directories now.
	(func_scan_files): Remove directory readability check...
	(func_nonemptydir_p): ...in favour of a dedicated sanity check
	function called from the main body.
	(_lt_pkgvdatadir): Set pkgdatadir and aclocaldir appropriately if
	this is in the environment.
	* configure.ac: Tests for `ln' removed.
	(APIVERSION): Removed.
	* Makefile.am (pkgvdatadir, nobase_dist_pkgvdata_DATA)
	(nobase_pkgvdata_DATA): Renamed to...
	(pkgdatadir, nobase_dist_pkgdata_DATA, aclocalfiles): ...these
	respectively.
	(edit): Adjust for new variable names.
	(install-data-local): Don't bother to remove old macro files that
	will be overwritten by the installation, and perform a manual
	installation of $(aclocalfiles) to preserve timestamps.
	(install-exec-hook): Removed.  No need to make versioned links.
	(uninstall-hook): No need to remove versioned links, but now we
	need to manually remove the manually installed $(aclocalfiles).
	* doc/libtool.texi: Remove bogus notes about setting
	ACLOCAL_AMFLAGS for versioned libtool installations.
	* NEWS: Remove parallel installation item.

2005-04-29  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/ltdl.m4 (all over): Quote all arguments to AC_DEFINE and
	AC_DEFINE_UNQUOTED consistently.  Reported by
	Michael Koch  <konqueror@gmx.de>, Riccardo Mottola <zuse@libero.it>,
	and Dalibor Topic <robilad@kaffe.org>.

	* HACKING: Updated.

2005-04-27  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/convenience.at: Actually add.

	* tests/convenience.at: New.  Test convenience archives.
	* Makefile.am, tests/testsuite.at: Adjust.
	* tests/testsuite.at: Reorder tests.  Suspend AT_TESTED.
	(PREPARE_TESTS): Define EGREP, host, build, LIBTOOL.
	(LT_AT_BOOTSTRAP): Fail if autoreconf fails.
	(LT_AT_EXEC_CHECK): New macro for execution of $build binaries.
	(LT_AT_TAG): New macro to test tag availability or skip test.
	* tests/am-subdir.at, tests/duplicate_members.at, tests/inherited_flags.at,
	tests/link-order.at, tests/stresstest.at, tests/template.at:
	Adjust.  Use LT_AT_TAG, LT_AT_EXEC_CHECK, AT_KEYWORDS.
	Use compiler/linker flags consistently.
	* tests/link-order.at: Fix use of AT_DATA, bogus redirection
	inside AT_CHECK.
	* tests/stresstest.at: Do not use wildcards/regex in symbol files,
	they are not portable.  Use -no-undefined on win32.  Fix to ignore
	compile/link warnings.

	* tests/f77demo/foo.h, tests/f77demo/fooc.c, tests/f77demo/cprogram.c,
	tests/mdemo2/main.c, tests/pdemo/foo.h: Make declarations available.

	* m4/libtool.m4 (_LT_SYS_DYNAMIC_LINKER) [ linux ]: sed 3.02 does
	not understand \t in regex.
	Reported by Tim Van Holder <tim.vanholder@gmail.com>.

	* tests/defs.m4sh (func_configure): Don't run the whole configure
	script with -x.

	* config/ltmain.m4sh: Audit use of echo vs $ECHO.
	Reported by Robert Ögren <lists@roboros.com> and others.

	* TODO: Updated.

2005-04-26  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>,
	    Gary V. Vaughan  <gary@gnu.org>

	* HACKING, THANKS: Updated.

2005-04-25  David Edelsohn  <dje@watson.ibm.com>

	* m4/libtool.m4 (_LT_LINKER_SHLIBS): _LT_TAGDECL(file_list_spec).
	* config/ltmain.m4sh (func_mode_link): Change $filelist to $output.

2005-04-24  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_CC_BASENAME): Ignore `compile'.

2005-04-23  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_COMPILER_PIC, _LT_LINKER_SHLIBS) [solaris]:
	Update wl for Sun Studio f77/f90/f95.  Fix whole_archive_flag_spec
	for cc and f77/f90/f95 to prevent reordering in case we link with $CC.

	* m4/libtool.m4: Audit use of echo vs $ECHO.
	* TODO: Update.
	Reported by Robert Ögren <lists@roboros.com> and others.

2005-04-23  Gary Kumfert <kumfert@llnl.gov>

	* m4/libtool.m4 (_LT_LANG_F77_CONFIG) [ aix4, aix5 ]:
	Adjust logic to match the C case: Only disable static if not
	on ia64 nor runtimelinking.

2005-04-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny change)

	* Makefile.am, HACKING: Use lt__cd throughout.

2005-04-22  Gary V. Vaughan  <gary@gnu.org>

	The FSF are moving offices today.  Changed their contact address
	in all files from `59 Temple Place, Suite 330, MA 02111-1307' to
	`51 Franklin Street, Fifth Floor, MA 02110-1301'.

2005-04-19  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libtoolize.m4sh (func_scan_files, func_serial, func_ltmain_update,
	func_config_update, func_install_update): Placate AIX sed.

2005-04-19  David Edelsohn  <dje@watson.ibm.com>

	* config/ltmain.m4sh (func_mode_link): If command exceeds
	max_cmd_len and file_list_spec exists, write list of input files
	to temporary file.
	* m4/libtool.m4 (_LT_LINKER_SHLIBS, aix[45]): Define file_list_spec.
	(_LT_LANG_CXX_CONFIG, aix[45]): Define file_list_spec.

2005-04-18  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/demo-hardcode.test: Fix typo.

2005-04-17 Alexandre Oliva  <aoliva@redhat.com>,
	   Peter O'Gorman  <peter@pogma.com>

	* config/ltmain.m4sh: Don't add files with the same base name to an
	archive; rename duplicates instead.
	(func_extract_an_archive): Remove section to deal with duplicate
	base names in an archive.
	* tests/functests.at: remove.
	* tests/duplicate_members.at: new test.
	* tests/testsuite.at: Add new test, remove old.
	* Makefile.am: Add new test, remove old.

2005-04-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/demo-hardcode.test [solaris]:  Use dumpstabs if available,
	to avoid false failure caused by debug section which contains
	command line (Solaris cc).
	Reported by Ralf Menzel <menzel@ls6.cs.uni-dortmund.de>.

2005-04-17  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny change)

	* libtoolize.m4sh (func_copy_cb): Fix syntax typo.

2005-04-15  Maciej W. Rozycki  <macro@linux-mips.org>

	* m4/libtool.m4 (_LT_LANG_GCJ_CONFIG): Add old_archive_cmds
	definition.

2005-04-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_CC_BASENAME): New macro to figure out $cc_basename.
	Skip ccache, distcc, purify, cmdline options, `$host_alias-' prefix.
	(_LT_SETUP, _LT_LANG_CXX_CONFIG, _LT_LANG_F77_CONFIG,
	_LT_LANG_GCJ_CONFIG, _LT_LANG_RC_CONFIG): Use.
	* NEWS, TODO: Update.

2005-04-15  Gary V. Vaughan  <gary@gnu.org>

	* libltdl/configure.ac (AC_OUTPUT): loaders/Makefile is no longer
	used.

	* Makefile.am (lt__cd, CD_TESTDIR): New make macros to work around
	problems with CDPATH in some shells.
	(check-local, installcheck-local, clean-local): Use them.

2005-04-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny change)

	* bootstrap: Define srcdir for making `commit'.

2005-04-14  Alexandre Oliva  <aoliva@redhat.com>,
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/ltmain.m4sh (link mode): Add to tmp_libs paths for libtool dep
	libs in reverse order as well.
	* Makefile.am, tests/testsuite.at, tests/link-order.at: New test.

2005-04-13  Gary V. Vaughan  <gary@gnu.org>

	Since the bootstrap process requires that several of the rules for
	files generated in doc and tests already lived in
	$top_srcdir/Makefile.am, along with proxy rules in sub-Makefiles,
	this changeset consolidates almost everything into the top
	Makefile.am, simplifying things considerably:

	* doc/Makefile.am, tests/Makefile.am: Removed.  All rules moved...
	* Makefile.am: ...to here and adjusted to run from $top_builddir.
	Some reformatting to group rules and declarations by purpose, and
	simplify with respect to removing much of the make recursion.
	Add `doc/PLATFORMS', `doc/fdl.texi' and `doc/notes.texi'.
	`defs.in' and `defs.m4sh' are in directory `tests'.
	(uninstall-hook): Don't forget to uninstall libtoolize's libltdl
	source tree.
	* bootstrap: Simplified dirty makefile management, and bootstrap
	file creation in light of having only a single pertinent
	Makefile.
	* configure.ac (CONF_SUBDIRS): Add tests/ prefix to each subdir to
	compensate.
	(DIST_MAKEFILE_LIST): Adjust.
	(AC_CONFIG_FILES): Remove doc/Makefile and tests/Makefile.
	* tests/defs.m4sh (LIBTOOL, scripts): Adjust paths.
	* tests/cdemo-conf.test, tests/cdemo-exec.test,
	tests/cdemo-make.test, tests/cdemo-shared.test,
	tests/cdemo-static.test, tests/cdemo-undef.test,
	tests/demo-conf.test, tests/demo-deplibs.test,
	tests/demo-exec.test, tests/demo-hardcode.test,
	tests/demo-inst.test, tests/demo-make.test,
	tests/demo-nofast.test, tests/demo-noinst-link.test,
	tests/demo-nopic.test, tests/demo-pic.test,
	tests/demo-relink.test, tests/demo-shared.test,
	tests/demo-static.test, tests/demo-unst.test,
	tests/depdemo-conf.test, tests/depdemo-exec.test,
	tests/depdemo-inst.test, tests/depdemo-make.test,
	tests/depdemo-nofast.test, tests/depdemo-relink.test,
	tests/depdemo-shared.test, tests/depdemo-static.test,
	tests/depdemo-unst.test, tests/f77demo-conf.test,
	tests/f77demo-exec.test, tests/f77demo-make.test,
	tests/f77demo-shared.test, tests/f77demo-static.test,
	tests/link-2.test, tests/link.test, tests/mdemo-conf.test,
	tests/mdemo-dryrun.test, tests/mdemo-exec.test,
	tests/mdemo-inst.test, tests/mdemo-make.test,
	tests/mdemo-shared.test, tests/mdemo-static.test,
	tests/mdemo-unst.test, tests/mdemo2-conf.test,
	tests/mdemo2-exec.test, tests/mdemo2-make.test, tests/nomode.test,
	tests/objectlist.test, tests/pdemo-conf.test,
	tests/pdemo-exec.test, tests/pdemo-inst.test,
	tests/pdemo-make.test, tests/quote.test, tests/sh.test,
	tests/suffix.test, tests/tagdemo-conf.test,
	tests/tagdemo-exec.test, tests/tagdemo-make.test,
	tests/tagdemo-shared.test, tests/tagdemo-static.test,
	tests/tagdemo-undef.test, tests/tagtrace.test (func_cd,
	func_require): Adjust paths..

2005-04-12  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/general.m4sh, libtool.m4 (_LT_SETUP), tests/defs.m4sh,
	tests/functests.at: Fix definition of $Xsed.

2005-04-07  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Improved Portland support: prelinking of C++ templates and
	whole_archive.

	* m4/libtool.m4 (_LT_COMPILER_PIC, _LT_LINKER_SHLIBS) [ linux ]:
	Reinstate formatted whole_archive_flag_spec for PGI compilers.
	* config/ltmain.m4sh (func_mode_link), m4/libtool.m4
	(_LT_LINKER_SHLIBS): New tag prelink_cmds, to be executed before
	linking a program.
	(_LT_LANG_CXX_CONFIG) [ linux ]: Use for pgCC.
	(_LT_COMPILER_C_O): conftest might be nonempty, clean up more
	thoroughly.

	* tests/testsuite.at (LT_AT_BOOTSTRAP): Temporary fix for testing
	in-tree libtoolize.

	* m4/libtool.m4 (_LT_CONFIG_COMMANDS): Only call sed if
	necessary while quoting all libtool variables.
	Reported by Robert Ögren <lists@roboros.com>.

2005-04-05  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/Makefile.am: Typo.

2005-04-04  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* notes.texi: Platform-specific configuration notes.
	* doc/libtool.texi: Include as section.
	* bootstrap, doc/Makefile.am: build also as notes.txt and
	distribute.

2005-04-04  Gary V. Vaughan  <gary@gnu.org>

	Under certain circumstances, not all of the macro files were
	copied into the destination directory.  This changeset fixes
	that bug:

	* libtoolize.m4sh (func_serial_update):  Renamed local variable
	`my_update_p' to `my_serial_update_p', and initialise it correctly
	even when the destination file is not yet there.
	Reported by Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

2005-04-04  Gary V. Vaughan  <gary@gnu.org>

	* tests/libtoolize.at: New tests for basic libtoolize functionality
	and reporting.
	* tests/testsuite.at: Call them.
	* tests/Makefile.am: Distribute them.

	* libtoolize.m4sh (pkgvdatadir): Renamed from this...
	(_lt_pkgvdatadir): ...to this.
	* tests/testsuite.at (LT_AT_LIBTOOLIZE): The `-I' option is no
	longer supported by libtoolize.  Set _lt_pkgvdatadir in the
	environment of the invocation instead.

2005-04-04  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/template.at: New Autotest tests for C++ with templates.
	First test provided by Markus Christen <markus@igc.phys.chem.ethz.ch>.
	* tests/Makefile.am, tests/testsuite.at: Use and distribute.

2005-04-04  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (func_serial_update): Replace missing
	destination serial calculation line, presumably lost due to a bad
	merge.

	* libltdl/loaders/Makefile.am: Removed actually.

2005-04-04  Gary V. Vaughan  <gary@gnu.org>

	Getting the value of ltdldatafiles from a submake was not
	portable, and had problems with GNU make-3.80 at least.  This
	changeset pulls the installation rules for libtoolize's copy of
	the libltdl sources out of libltdl/Makefile.am so that
	ltdldatafiles is defined in the same Makefile that uses it.  Also,
	this makes a start at cleaning up libltdl/Makefile.am so that it
	is useful in a package that uses `libtoolize --ltdl':

	* libltdl/loaders/Makefile.am: Removed entirely.
	* libltdl/Makefile.am (dlopen.la, dld_link.la, dyld.la)
	(load_add_on.la, loadlibrary.la, shl_load.la): All built from here
	now that the loaders submake has gone.
	(show-ltdldatafiles): Removed.  No longer required.
	(ltdldatadir, ltdldatafiles, install-local): Moved from here...
	* Makefile.am (ltdldatadir, ltdldatafiles, install-local): ..to
	here.
	(libtoolize): Substitute $(ltdldatafiles) directly without calling
	make to get the value from libltdl/Makefile.

2005-04-01  Gary V. Vaughan  <gary@gnu.org>

	* Makefile.am (libtoolize): Substitute $(nobase_pkgvdata_DATA).
	pkgvmacro_DATA is no longer set in the makefile.
	* libtoolize.m4sh (func_massage_pkgvmacro_DATA): Use it and, for
	consistency, renamed from this...
	(func_massage_nobase_pkgvdata_DATA): ...to this.  Adjust all
	callers.

2005-04-01  Gary V. Vaughan  <gary@gnu.org>

	Fix problems with serial comparison sed scripts, and factor out
	common code from similar serial comparison functions:

	* libtoolize.m4sh (func_keyword_update): Common code factored out
	of func_ltmain_update and func_config_update.
	(func_ltmain_update, func_config_update): Adjust, and fix sed
	expressions to not use unportable ? modifier.
	(func_install_update): New serial number based file updater keyed
	off 'scriptversion' variable in install-sh.  Adjust all callers.

2005-04-01  Gary V. Vaughan  <gary@gnu.org>

	Most of the hair introduced ostensibly to enable testing of
	uninstalled libtoolize isn't necessary if we allow overriding of
	the libtool master copy directory:

	* configure.ac (pkvmacrodir): No need to substitute this.
	* Makefile.am (edit): No need to substitute pkgvmacrodir.
	(dist_pkgvdata_DATA): Use nobase_ prefix so that these files are
	installed to $(pkgvdatadir)/config.
	(pkgvmacro_DATA): Renamed to...
	(nobase_pkgvdata_DATA): ...this, so that files are installed to
	$(pkgvdatadir)/m4.
	(install-data-hook): Adjust.
	* libtoolize.m4sh: Remove -I processing.
	(func_filename_path_search): No longer required without -I.
	Adjust all callers.
	(pkgvltdldirs, pkgvmacrodirs): Deleted.
	(pkgvdatadir): Allow overriding from the environment so that we
	can write tests for uninstalled libtoolize.
	(func_serial_update, func_ltmain_update, func_config_update):
	Rename srcdirs parameter to srcdir, and don't call the path_search
	function anymore.  Adjust all callers.
	(--install): Don't blindly copy all config files.

2005-04-01  Mike Stump  <mrs@apple.com>

	* m4/libtool.m4 (LT_CMD_MAX_LEN) [ netbsd, freebsd, openbsd,
	darwin, dragonfly]: Use 3/4 of argmax, instead of 1/4.

2005-03-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_LANG_GCJ_CONFIG, _LT_LANG_RC_CONFIG):
	Set $cc_basename.

	* HACKING: echo vs $ECHO.

2005-03-28  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny change)

	* doc/libtool.texi: Minor formatting cleanups.

2005-03-24  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh: Propogate --debug flag to sub-libtoolizes.

	* libtoolize.m4sh: Fix a typo, s/pkgvltdldirs/pkgvdatadirs/.
	When using -I to test an uninstalled libtoolize, we need to add
	the config subdirectory to the search path so that ltmain.sh can
	be found in the source tree.

	* libtoolize.m4sh (func_copy_some_files): IFS needs to be set to
	path delimiter for all inner loop iterations.
	Once a matching file has been copied, no need to keep searching
	the path for another -- move on to the next file!

	* libtoolize.m4sh: For verbose mode, explain why macro files are
	not installed without an AC_CONFIG_MACRO_DIR declaration.

2005-03-24  Gary V. Vaughan  <gary@gnu.org>

	As a prerequisite for being able to test an uninstalled libtoolize
	for copying files correctly from the source tree, we must know
	exactly which files should be copied by the --ltdl option to avoid
	accidentally picking up compilation objects and other noise when
	$builddir == $srcdir:

	* libltdl/loaders/Makefile.am (ltdldatadir, ltdldatafiles)
	(install-data-local): Removed...
	* libltdl/Makefile.am (ltdldatafiles): ...and consolidated here.
	(show-ltdldatafiles): New rule...
	* Makefile.am (ltdldatafiles, libtoolize): ...used to substitute
	exactly which files are installed by libtoolize --ltdl.
	(edit): Move pkgvmacro_DATA substitution expression...
	(libtoolize): ...to here.
	* libtoolize.m4sh: Use func_copy_some_files() instead of
	func_copy_all_from_path() to copy the --ltdl option installed
	files.
	(pkgvltdldirs): New path variable to search for	files installed by
	--ltdl option.
	(func_massage_pkgvltdl_files): New function to calculate the list
	of ltdl installation files.

2005-03-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny change)

	* m4/libtool.m4, m4/ltdl.m4: Indentation and quoting cleanup.

2005-03-22  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_LINKER_SHLIBS) [solaris]: Use ${wlarc}
	and set to empty when using $LD for linking.  Fixes regression
	introduced in 2004-11-17.
	Reported by Ralf Menzel <menzel@ls6.cs.uni-dortmund.de> and
	Пухальский Юрий Андреевич <pooh@cryptopro.ru>.

2005-03-21  Gary V. Vaughan  <gary@gnu.org>,
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_SETUP, _LT_LANG_CXX_CONFIG, * _LT_LANG_F77_CONFIG):
	For matching compiler names: Pick only first word, allow leading white
	space..
	* tests/sh.test: ..and test for missing `*' at end of patterns.

2005-03-21  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* TODO: Update.

2005-03-20  Peter Ekberg  <peda@lysator.liu.se>

	* m4/libtool.m4 (_LT_LINKER_SHLIBS) [ irix5, irix6, nonstopux ]:
	Test if it is possible to use the -exports_file linker option on
	irix with gcc, as the gcc specs file may include a -hidden_symbol
	option that is clashing with the -exports_file option.
	See this gcc bugzilla entry for further details:
	http://gcc.gnu.org/bugzilla/show_bug.cgi?id=15288
	* THANKS: Update.

2005-03-19  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/demo-nopic.test: Enhance status output
	noted by Tom Burger <tvburger@few.vu.nl>.

2005-03-18  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/ltmain.m4sh, tests/defs.m4sh: Typos.

2005-03-18  Peter O'Gorman  <peter@pogma.com>,
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4: The compiler can be a program name with args, so
	always check cc_basename against compiler name and a wildcard.
	Also, drop unnecessary quotes in `case' argument.

2005-03-16  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* Makefile.am: tests/defs.in depends on config/general.m4sh.

	* config/general.m4sh: unconditionally set IFS, and set it
	to the one true right sequence: space, tab, newline.
	* m4/libtool.m4: remove IFS setting and as_* namespace infringement.

	* m4/libtool.m4 (_LT_CONFIG): Reset IFS to fix failure with ash.

	* configure.ac, libltdl/configure.ac: s/##/dnl/ for comments
	that are meaningless in configure.
	Reported by Alexandre Duret-Lutz <adl@src.lip6.fr>.

2005-03-15  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/configure.ac: Update version; require Autoconf >= 2.59.

	* bootstrap: Allow to override tools.

2005-03-15  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (func_massage_pkgvmacro_DATA): New function
	to calculate the macro filenames to be copied by libtoolize.
	* Makefile.am (edit): Substitute pkgvmacro_DATA.

	* bootstrap: Need to generate tests/package.m4 from Makefile.am
	before generating tests/testsuite from tests/Makefile.am, or
	else bootstrap of a fresh checkout fails.

2005-03-14  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_COPYING): Update Copyright year.

	* m4/libtool.m4 (_LT_LINKER_SHLIBS) [linux]: Remove MAIN_
	dependency when creating shared libraries with Portland pgf77.

2005-03-12  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* configure.ac: stamp-vcl is in $top_srcdir, not $top_builddir.

2005-03-12  Per Bothner <per@bothner.com>,
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Allow special characters in source file names.  Will break unless
	`-o target' is also given, which must not contain special characters.
	En passant, fix source file quoting broken for cygwin/MSVC.

	* config/ltmain.m4sh (func_mode_compile): Use new variable qsrcfile
	for quoted source file name for compile $command.  Fix missing
	quotes for _c_o lockfile.
	* NEWS: Update.

2005-03-12  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/ltmain.m4sh (func_mode_link): Reword double negation in
	error message.  Reported by Jesper Louis Andersen <jlouis@mongers.org>.

	* bootstrap: really remove bogus files Makefile tests/Makefile.

	* doc/libtool.texi: Replace wicked whiches by thats or other
	better-sounding constructs.

2005-03-11  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>  (tiny change)

	* tests/Makefile (clean-local): Ignore testsuite cleanup
	failures.

2005-03-11  Per Bothner  <per@bothner.com>  (tiny change)

	* tests/Makefile (clean-local): Only run the testsuite cleanup
	if the testsuite has been generated.

2005-03-10  Gary V. Vaughan  <gary@gnu.org>

	* libltdl/Makefile.am (install-data-local): Don't force v7 tar
	format with the `o' flag in create mode.
	Set the umask to 0 when untarring to avoid copied files taking
	their mode from the installer's umask.
	* libltdl/loaders/Makefile.am (install-data-local): Ditto.
	* libtoolize.m4sh (func_copy_cb): Ditto.
	Ignore errors from failed `cd' in the tar processes, since we
	may be running in dryrun mode.
	Reported by Noah Misch <noah@cs.caltech.edu>,
		Bob Friesenhahn <bfriesen@simple.dallas.tx.us>

2005-03-10  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/Makefile.am: $(builddir) is not defined, replace by `.'.

2005-03-08  Albert Chin-A-Young  <china@thewrittenword.com>

	* m4/libtool.m4 (_LT_LINKER_SHLIBS, _LT_LANG_CXX_CONFIG)
	[irix*, osf*]: Output -update_registry information to
	${output_objdir} directory, not ${objdir}. ${output_objdir}
	will work when a project has a single Makefile and performs
	builds in subdirectories. ${objdir} expects the source in
	the current directory, breaking single-Makefile builds.

2005-03-08  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/stresstest.at: Remove multiple variable definition.

	* TODO: Update.

	* THANKS: Update.

2005-03-02  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (func_copy_cb): Use tar chof to avoid symlink
	attacks.
	* libltdl/Makefile.am, libltdl/loaders/Makefile.am
	(install-data-local): Ditto.

2005-02-27  Gary V. Vaughan  <gary@gnu.org>

	In branch-2-0 (and in time, others) ltversion.m4 has a dot
	delimited serial number that didn't used to be processed
	correctly by libtoolize.  This changeset fixes that, and
	leverages those changes to check versions of ltmain.sh and
	config.sub, config.guess before overwriting when --force is
	not given:

	* libtoolize.m4sh: Don't overwrite pkgaux files with --force
	unless --install is given too.
	(func_serial): Fix underquoting in regexp.
	(func_serial_max): New function to compare serial numbers.
	(func_serial_update_check): New function factored out of
	func_serial_update().
	(func_serial_update): Bail if SRCFILE is missing.
	Don't display both 'already up to date' and 'use --force to
	update' messages for the same file.
	Use func_serial_max to cope with `.' delimited serial numbers.
	(func_ltmain_update): Use func_serial_update_check and
	func_serial_max to do version checking with $package_revision.
	(func_config_update): Ditto with $timestamp.

2005-02-26  Gary V. Vaughan  <gary@gnu.org>

	* libltdl/Makefile.am (install-data-local):  cd to $(srcdir) before
	tarring up the files for installation to $(DESTDIR)$(ltdldatadir).
	Don't remove the destination directory, since that interacts badly
	with the multi-Makefile installation.
	* libltdl/loaders/Makefile.am (install-data-local): Ditto.

2005-02-26  Gary V. Vaughan  <gary@gnu.org>

	I assume that it is okay to have undefined symbols in convenience
	libraries that will be used as modules -- the pic objects are
	built normally, and are not expected to resolve all their symbols
	until they are linked into a library; convenience libraries are
	then rolled using 'ar' and 'ranlib' (or equivalent) which also do
	not check whether symbols are resolved.  We now build each of the
	loaders as a convenience library module under these assumptions,
	and link libltdl.la with selected modules, at which time all of
	the symbols *are* resolved:

	* TODO: Remove item addressed by this changeset.
	* libltdl/Makefile.am (lib_LTLIBRARIES): Remove libdlloader.la.
	(libdlloader_la_SOURCES): Declaration removed.  Changed all
	clients.  Source files..
	(libltdl_la_SOURCES): ...added back in here.
	(libdlloader_LDFLAGS, libdlloader_la_LIBADD): Removed.
	(libltdl_la_LIBADD): Remove libdlloader.la; add $(LTLIBOBJS).
	* libltdl/loaders/Makefile.am: Removed all references to
	libdlloader.la.

2005-02-25  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (func_copy): Split arguments to func_copy_cb
	calls across lines so that quote.test doesn't misdiagnose nested
	quotes.

	* m4/libtool.m4 (_LT_LANG_CXX_CONFIG, _LT_COMPILER_PIC):
	Fix some typos -- s/_LT_AC_TAGVAR/_LT_TAGVAR/g.

2005-02-24  Peter O'Gorman  <peter@pogma.com>

	* m4/libtool.m4 (_LT_LINKER_SHLIBS): The Portland group's
	compiler does not pass --whole-archive. Move gnu ld check for
	the flag to the top so it can be overridden.
	(_LT_LANG_CXX_CONFIG, _LT_COMPILER_PIC): Unset
	whole_archive_flag_spec for the portland group's c++ compiler too.
	Reported by Jeff Squyres <jsquyres@lam-mpi.org>

2005-02-23  Gary V. Vaughan  <gary@gnu.org>

	* libltdl/Makefile.am (install-data-local): Don't forget about
	$(DESTDIR).
	* libltdl/loaders/Makefile.am (install-data-local): Ditto.

2005-02-23  Gary V. Vaughan  <gary@gnu.org>

	Preserving the installed timestamps for libltdl sources from
	`libtoolize --ltdl --copy' is pointless if they are not preserved
	from the libtool source tree at install time:

	* libltdl/Makefile.am, libltdl/loaders/Makefile.am
	(nobase_ltdldata_DATA): Renamed to...
	(ltdldatafiles): ...this.
	(install-data-local): New rule to install libltdl tree with tar to
	preserve timestamps.

2005-02-23  Christoph Egger  <Christoph_Egger@gmx.de> (tiny change)

	* config/ltmain.m4sh (func_mode_link): Add -pthread like flags to
	inherited_linker_flags.

2005-02-22  Gary V. Vaughan  <gary@gnu.org>

	* libtoolize.m4sh (func_copy_cb): self.leg->shoot_off() :-/
	Let's not redirect stdout to null when sending tar output to a
	pipe.

2005-02-22  Gary V. Vaughan  <gary@gnu.org>

	Using `libtoolize --copy --ltdl' was not preserving timestamps, so
	parts of the autoconf bootstrap would be rerun spuriously after
	the files had been copied into the source tree:

	* libtoolize.m4sh (TAR): New default tar command.
	(func_copy_cb): Move the core copying internals to here, using
	$TAR to transfer files if possible when --copy was specified.
	(func_copy): Adjust to call func_copy_cb.
	* TODO: Remember to refactor this fix in due course.
	Reported by Jeff Squyres <jsquyres@lam-mpi.org>

2005-02-21  Peter O'Gorman  <peter@pogma.com>

	* config/ltmain.m4sh (func_extract_archives) [darwin]: This didn't
	actually work on a real fat archive, should do now.
	* tests/functests.at [darwin]: remove darwin fat tests which
	did not actually work.

2005-02-07  Peter O'Gorman  <peter@pogma.com>

	* config/ltmain.m4sh: Add -pthread like flags when linking
	executables too.
	Reported by Andreas Schwab <schwab@suse.de>

2005-02-04  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/ltmain.m4sh (func_mode_link): Allow five digits in
	version-info.

	* NEWS: s/Linux/GNU &/.

2005-02-03  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/Makefile.am, tests/testsuite.at, tests/stresstest.at:
	New test.  Stresses several combinations of link flags and
	path specifications.  Uses several data types to test linkage
	against symbols in all kinds of (e.g., ELF) sections.

2005-02-03  Reid Spencer  <reid@x10sys.com>,
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/ltmain.m4sh (func_generate_dlsyms): Fix broken subdir
	path computation, exposed by using `-dlopen self'.  Fix broken
	sed script exposed by additionally using `-export-symbols FILE'.

2005-02-03  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* THANKS: Update.

	* THANKS: Update.

2005-02-03  Peter O'Gorman  <peter@pogma.com>

	* config/ltmain.m4sh [darwin]: Don't add installed libs to
	temp_rpath when building executables on darwin, or other systems
	which use hardcode_automatic. It may break our wrapper scripts.

2005-02-02  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/getopt.m4sh (func_version, func_usage, func_help,
	* config/ltmain.m4sh (func_mode_help, func_config, func_features):
	Exit with nonzero status on write failures.

	* tests/sh.test: Check for preferred function definition layout.

2005-02-01  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_SYS_DYNAMIC_LINKER)
	[ pw32, freebsd3.[01], freebsdelf3.[01] ]
	(_LT_LINKER_SHLIBS) [ linux with GNU ld < 2.11, aix4.[012]* ]
	(_LT_LANG_CXX_CONFIG) [ aix4.[012]*, freebsd[12], solaris2.[0-5] ]
	(_LT_LANG_GCJ_CONFIG): Fix [] quoting.  Should fix various spurious
	failures.

	* tests/Makefile.am: Add `atconfig' to DISTCLEANFILES.

	* clcommit.m4sh: Test whether the shell understands `read -r'.  Use as
	`$read_r' if available, so `\' is preserved in commit notices.

	* HACKING (Editing `.m4sh' Files): Document preferred function
	header layout.
	* config/ltmain.m4sh (func_win32_libid, func_infer_tag)
	(func_generate_dlsyms, func_extract_an_archive, func_extract_archives):
	adjust to fit.

2005-01-31  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_CMD_GLOBAL_SYMBOLS): Unicos 9 sed rejects
	empty parentheses as in 's/x\(\)/\1/'.
	(_LT_COMPILER_PIC) [unicos*]: wl=-Wl,.
	* tests/sh.test: Not all sed's like '/.*\n.*/' (Unicos 9 sed
	loops endlessly).

	* tests/quote.test: Match link quoting against `"$wl"', not `-Wl,'.

	* tests/quote.test: Check for `--no-reexec' in $1 to avoid one reexec.

	* m4/libtool.m4 (_LT_COMPILER_C_O): _LT_TAGDECL(lt_compiler_c_o),
	not _LT_DECL, since this is tag-dependent.

	* config/ltmain.m4sh, m4/libtool.m4: Change `( cmd ) 2>/dev/null' to
	`{ cmd; } 2>/dev/null', when cmd has no side effects and might be a
	builtin.  Note that it is unspecified whether cmd will run within a
	subshell (e.g. Bourne shells) or within the current shell (most modern
	shells).

2005-01-29  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_LINKER_SHLIBS, _LT_LANG_CXX_CONFIG) [linux]:
	Update for Intel Compiler icc/icpc/ifort: add -i_dynamic and
	-nofor_main, if necessary.  Simplify logic somewhat.

2005-01-26  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/Makefile.am: also re-export CPP, CXXCPP, and the value of
	SHELL as CONFIG_SHELL.
	Reported by Heinz Salzmann <heinz.salzmann@micronas.com>.

2005-01-26  Craig Dooley  <xlnxminusx@gmail.com>,
	    Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* NEWS, m4/libtool.m4, config/ltmain.m4sh [dragonfly]:
	Add support for DragonFly.

2005-01-26  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_PROG_XSI_SHELLFNS): Work around pdksh
	positional parameter expansion bug.

2005-01-25  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* config/ltmain.m4sh: Fix endless loop in cmdline parsing.

2005-01-25  Albert Chin-A-Young  <china@thewrittenword.com>

	* config/ltmain.m4sh (func_mode_link) [irix]: Preserve processor
	option for SGI Compiler (-r[0-9][0-9]*).

2005-01-24  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* m4/libtool.m4 (_LT_PROG_XSI_SHELLFNS): Define Bourne and XSI
	variants of new function func_stripname for stripping literal
	prefixes and suffixes.
	* config/ltmain.m4sh (all over): Use func_stripname.

	* tests/defs.m4sh: Extract $build from $LIBTOOL.
	(func_configure): Pass --host if $host != $build.
	(func_exec): Try executing cross-compiled binaries (e.g. i686 -> i386),
	but SKIP rather than FAIL.
	* tests/depdemo-relink.test: Do not try to access possibly non-
	existent files.  SKIP rather than FAIL or PASS falsely when
	cross-compiling.

	* m4/libtool.m4 (_LT_SETUP) [mingw, cygwin, pw32, os2]:
	Add _LT_DECLs for host_os, build_alias, build and build_os.
	host_os and build were used in a few occasions in ltmain.m4sh
	and affect above-mentioned systems, the others are added for
	symmetry and in order to be able to detect cross-compiling.

2005-01-23  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/Makefile.am: Add $(AM_LDFLAGS) to all per-target
	variables *_LDFLAGS as per CVS Automake semantic change.

2005-01-16  Peter O'Gorman  <peter@pogma.com>

	* config/ltmain.m4sh (func_mode_link): Don't pass through
	compiler-like thread flags when using $LD to do the linking.
	Use compiler_flags instead.
	Reported by Mark_Andrews@isc.org.

	* m4/libtool.m4 (LT_CMD_MAX_LEN) [osf]: On Tru64 there could
	be a kernel panic when testing the maximum command line length
	if exec_disable_arg_limit=1. Don't do the tests to figure it
	out on *-osf*.
	Reported by Dr. Hans Ekkehard Plesser
	<hans.ekkehard.plesser@umb.no>

2005-01-14  Guido Draheim  <guidod-2003-@gmx.de>  (tiny change)

	* m4/libtool.m4 (AC_PROG_SED): Don't break test loop early.

2005-01-12  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* TODO: Update.

	* libltdl/ltdl.c: Whitespace cleanup.

	* config/ltmain.m4sh: New option `--verbose'/`-v' to enable
	override of `--silent'.  Verbose is the default behavior.
	* doc/libtool.texi (Invoking libtool): Document it.

	* m4/libtool.m4 (_LT_SYS_DYNAMIC_LINKER) [linux]: While "parsing"
	/etc/ld.so.conf, skip comments.
	Reported by Jens Elkner <elkner@linofee.org>.

2005-01-10  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* libltdl/libltdl/lt__glibc.h: Move all exported slist
	symbols into the lt__* namespace.
	* libltdl/libltdl/lt__private.h, libltdl/libltdl/slist.h:
	Adjust includes.

2005-01-10  Peter O'Gorman  <peter@pogma.com>

	* config/ltmain.m4sh (func_mode_link): Fix
	inherited_linker_flags so it puts it on the link line when
	linking shared libraries as well as when linking executables.
	* tests/inherited_flags.at: test inherited_linker_flags.
	* tests/Makefile.am: Add test.
	* tests/testsuite.at: Add test.
	Reported by: Albert Chin-A-Young <china@thewrittenword.com>

2005-01-10  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/sh.test: After `set dummy [...]', check for `shift'
	within the same and following line.
	* config/ltmain.m4sh (func_enable_tag, func_mode_install)
	(func_mode_link): Sprinkle `shift's all over to conform to this.

2005-01-09  Gary V. Vaughan  <gary@gnu.org>

	* HACKING (Editing 'ChangeLog'): Follow the GCS with respect to
	attributions, and mention how to handle tiny changes.
	Reported by Alexandre Duret-Lutz <adl@src.lip6.fr>.

	* ChangeLog.2004: Trim 2005 entries.
	* ChangeLog: Add missing entries.

2005-01-08  Gary V. Vaughan  <gary@gnu.org>

	* ChangeLog: Move 2004 change logs from here...
	* ChangeLog.2004: ...to here.

	* m4/argz.m4, m4/libtool.m4, m4/ltdl.m4, m4/ltoptions.m4,
	m4/ltsugar.m4, m4/ltversion.m4, m4/lt~obsolete.m4: RMS says,
	'I think the [license of autoconf macro files] should be:
	# This file is free software; the Free Software Foundation
	# gives unlimited permission to copy and/or distribute it,
	# with or without modifications, as long as this notice is
	# preserved.'.

	* ChangeLog: Reformatting.
	* HACKING: Fix section numbering.
	(Editing 'ChangeLog'): New notes on ChangeLog entry format.

2005-01-03  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	* tests/am-subdir.at tests/testsuite.at (AT_BOOTSTRAP,
	AT_LIBTOOLIZE, AT_CHECK_LIBTOOLIZE): Rename to ...
	(LT_AT_BOOTSTRAP, LT_AT_LIBTOOLIZE, LT_AT_CHECK_LIBTOOLIZE):
	...and make use of new names.

Continued in ChangeLog.2004

	$Revision$ $Date$
